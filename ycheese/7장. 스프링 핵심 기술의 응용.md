# 7장. 스프링 핵심 기술의 응용

> 스프링이 가장 가치를 두고 적극적으로 활용하려고 하는 것은 결국 자바가 기반을 두고 있는 **객체지향 기술**이다.
> 

# SQL, DAO에서 분리하기

## 1. XML 설정

- 설정을 이용해 빈에 값을 주입
    - SQL을 설정 파일에 프로퍼티 값으로 정의해서 DAO에 주입
- 👎 단점 : 새로운 SQL이 필요할 때마다 프로퍼티, 변수, 메소드 추가 필요

## 2. SQL 맵 프로퍼티

- Map을 이용하여 키 값을 이용해 SQL 문장 가져오기
- xml에 <map> 태그를 사용해서 정의
- 👎 단점 : 키 값 등에 오타가 있어도 런타임에서만 확인할 수 있음

## 3. SQL 제공 서비스

- 인터페이스 - 구현체 클래스를 만들고 Map 프로퍼티를 추가
- DAO는 SQL을 어디서 가져오는지 신경쓰지 않는다.

# 인터페이스 분리와 자기 참조 빈

## 🌱 빈 초기화

### @PostConstruct

- 스프링에서 빈 오브젝트의 초기화 메소드를 지정할 때 사용
- 빈 오브젝트 생성 → DI → @PostConstruct가 붙은 메소드 자동 실행
- **생성자와 다른 점?**
    - 프로퍼티까지 모두 준비된 후에 실행됨

## 🎬 자기 참조 빈으로 시작하기

### 다중 인터페이스 구현과 간접 참조

- 세분화된 책임을 정의한 인터페이스 구현
- 같은 클래스 코드지만 책임이 다른 코드는 인터페이스를 통해 간접 접근

### 자기 참조 빈 설정

- ref 항목에 자기 자신을 넣는다.

## 👯 디폴트 의존관계

외부에서 DI 받지 않는 경우 자동 적용되는 의존관계

- 디폴트로 적용하고 싶은 의존 오브젝트를 생성자에 추가
- 빈 설정이 없어짐

# 인터페이스 상속으로 안전하게 확장하기

## 📣 DI와 확장

### DI를 의식하는 설계하기

- 커다란 오브젝트 하나만 존재하면 안됨
- 의존 관계를 가지고 협력해서 일하는 오브젝트가 필요함
    - 적절한 책임에 따른 오브젝트 분리
    - 의존 오브젝트는 자유롭게 확장될 수 있음
- 미래를 프로그래밍하자 !

### 인터페이스 프로그래밍

- 두 개의 오브젝트가 인터페이스를 통한 느슨한 결합을 맺는 것이 DI다운 DI
    - 다형성++
    - 인터페이스 분리 원칙
- 기존 인터페이스를 상속하여 확장할 수 있음

# DI로 다양하게 구현하기

## ConcurrentHashMap

- 동기화된 해시 데이터 조작에 최적화된 자료구조
    - 데이터 조작 시 전체 데이터에 대해 락을 걸지 않고 조회는 아예 사용하지 않음
    - 안전하고 성능이 보장되는 동기화된 HashMap

## 내장형 데이터베이스

- 저장되는 데이터 양이 많아지고 잦은 조회/변경이 일어나는 경우 추천
- 애플리케이션에 내장되어 애플리케이션과 함께 시작/종료되는 데이터베이스
- 메모리에 저장되어 I/O 부하가 적고 성능이 좋음
